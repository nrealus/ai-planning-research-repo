
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../sat_reasoner/">
      
      
        <link rel="next" href="../brancher/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.8">
    
    
      
        <title>Difference Logic Reasoner - AI Planning Research Project</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.046329b4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra_style.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AI Planning Research Project" class="md-header__button md-logo" aria-label="AI Planning Research Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AI Planning Research Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Difference Logic Reasoner
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AI Planning Research Project" class="md-nav__button md-logo" aria-label="AI Planning Research Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    AI Planning Research Project
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../cdcl_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example CDCL search
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../fundamentals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fundamentals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../constraint_expressions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constraint Expressions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Solver
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Solver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../solver_state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solver State
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solver Main Class
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_4" checked>
        
          <label class="md-nav__link" for="__nav_4_3_4" id="__nav_4_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reasoners
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3_4">
            <span class="md-nav__icon md-icon"></span>
            Reasoners
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../reasoner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reasoner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sat_reasoner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAT Reasoner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Difference Logic Reasoner
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Difference Logic Reasoner
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner" class="md-nav__link">
    DiffReasoner
  </a>
  
    <nav class="md-nav" aria-label="DiffReasoner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.propagators_active" class="md-nav__link">
    propagators_active
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.propagators_pending_for_activation" class="md-nav__link">
    propagators_pending_for_activation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.propagation_metadata_trail" class="md-nav__link">
    propagation_metadata_trail
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.theory_propagation_causes" class="md-nav__link">
    theory_propagation_causes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.next_solver_event_to_process_index" class="md-nav__link">
    next_solver_event_to_process_index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.PropaGroup" class="md-nav__link">
    PropaGroup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.Enabler" class="md-nav__link">
    Enabler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.ConstraintsDatabase" class="md-nav__link">
    ConstraintsDatabase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.ShortestPathTheoryPropCause" class="md-nav__link">
    ShortestPathTheoryPropCause
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.InvalidBoundsTheoryPropCause" class="md-nav__link">
    InvalidBoundsTheoryPropCause
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.EdgePropInferenceCause" class="md-nav__link">
    EdgePropInferenceCause
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.TheoryPropInferenceCause" class="md-nav__link">
    TheoryPropInferenceCause
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState" class="md-nav__link">
    DijkstraState
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.add_reified_difference_constraint" class="md-nav__link">
    add_reified_difference_constraint()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.on_solver_increment_decision_level_by_one" class="md-nav__link">
    on_solver_increment_decision_level_by_one()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.on_solver_backtrack_one_decision_level" class="md-nav__link">
    on_solver_backtrack_one_decision_level()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.propagate" class="md-nav__link">
    propagate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.explain" class="md-nav__link">
    explain()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_5" >
        
          <label class="md-nav__link" for="__nav_4_3_5" id="__nav_4_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Branchers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_5">
            <span class="md-nav__icon md-icon"></span>
            Branchers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../brancher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Brancher
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner" class="md-nav__link">
    DiffReasoner
  </a>
  
    <nav class="md-nav" aria-label="DiffReasoner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.propagators_active" class="md-nav__link">
    propagators_active
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.propagators_pending_for_activation" class="md-nav__link">
    propagators_pending_for_activation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.propagation_metadata_trail" class="md-nav__link">
    propagation_metadata_trail
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.theory_propagation_causes" class="md-nav__link">
    theory_propagation_causes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.next_solver_event_to_process_index" class="md-nav__link">
    next_solver_event_to_process_index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.PropaGroup" class="md-nav__link">
    PropaGroup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.Enabler" class="md-nav__link">
    Enabler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.ConstraintsDatabase" class="md-nav__link">
    ConstraintsDatabase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.ShortestPathTheoryPropCause" class="md-nav__link">
    ShortestPathTheoryPropCause
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.InvalidBoundsTheoryPropCause" class="md-nav__link">
    InvalidBoundsTheoryPropCause
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.EdgePropInferenceCause" class="md-nav__link">
    EdgePropInferenceCause
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.TheoryPropInferenceCause" class="md-nav__link">
    TheoryPropInferenceCause
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState" class="md-nav__link">
    DijkstraState
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.add_reified_difference_constraint" class="md-nav__link">
    add_reified_difference_constraint()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.on_solver_increment_decision_level_by_one" class="md-nav__link">
    on_solver_increment_decision_level_by_one()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.on_solver_backtrack_one_decision_level" class="md-nav__link">
    on_solver_backtrack_one_decision_level()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.propagate" class="md-nav__link">
    propagate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.reasoners.diff_reasoner.DiffReasoner.explain" class="md-nav__link">
    explain()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Difference Logic Reasoner</h1>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">
  
      <p>This module defines the "Difference logic reasoner"
(aka "diff reasoner", aka "stn reasoner") of the solver.</p>
<p>This reasoner is dedicated to handling reified difference constraints of
the form <code>X - Y &lt;= c</code> (where <code>X</code> and <code>Y</code> are variables, and <code>c</code> is a constant).</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h5 id="src.solver.reasoners.diff_reasoner.DiffReasoner" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DiffReasoner</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">DiffReasoner</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">SolverState</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="src.solver.reasoners.reasoner.Reasoner" href="../reasoner/#src.solver.reasoners.reasoner.Reasoner">Reasoner</a></code></p>

  
      


  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.propagators_active" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">propagators_active</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">propagators_active</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">SignedVar</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">SignedVar</span><span class="p">,</span> <span class="n">Bound</span><span class="p">,</span> <span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>"Reverse" adjacency list of currenctly active edges / propagators.</p>
<p>The key of the dictionary corresponds to the target of the edge / propagator.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.propagators_pending_for_activation" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">propagators_pending_for_activation</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">propagators_pending_for_activation</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">,</span> <span class="n">DiffReasoner</span><span class="o">.</span><span class="n">Enabler</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>A queue containing the propagators that are pending for (i.e. "have been marked for") activation.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.propagation_metadata_trail" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">propagation_metadata_trail</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">propagation_metadata_trail</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[[]]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>History of propagation events metadata. Outer list index: decision level.
Inner list content corresponds to either:
- The activation of a propagator group.
- The triggering of theory propagation and appendance of its
cause in <code>theory_propagation_causes</code>. Encoded as None.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.theory_propagation_causes" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">theory_propagation_causes</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">theory_propagation_causes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">TheoryPropCause</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>History of all performed theory propagations' causes.</p>
<p>A theory propagation cause is added to this list when a None is added to <code>propagation_metadata_trail</code>.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.next_solver_event_to_process_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">next_solver_event_to_process_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">next_solver_event_to_process_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The index of the next unprocessed (i.e. not yet propagated)
event in <code>SolverState._events_trail</code>.</p>
  </div>

</div>


<div class="doc doc-object doc-class">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.PropaGroup" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">PropaGroup</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h6>


  <div class="doc doc-contents ">

  
      <p>Represents a group of (elementary) propagators for (maximum)
difference constraints. The propagators of the group only differ
by their enabling conditions (corresponding to <code>potential_enablers</code>).</p>

<details class="note" open>
  <summary>Note</summary>
  <p>In general, a propagator can be seen as an implicit encoding of
a constraint, since its purpose is to propagate an update on one
of its variables to the other ones.</p>
<p>Our elementary propagators for difference constraints (see [1])
allow us to reflect (i.e. propagate) the consequences of an update
on the bound of the <code>source</code> signed variable on the bound of the
<code>target</code> signed variable, when some conditions hold (the "enabling conditions").</p>
<p>As such, by abuse of language and notation, a propagator in our case
can also be seen as an encoding for a (directed) edge of a STN.</p>
<p>[1]: Bit-Monnot, Arthur. "Enhancing Hybrid CP-SAT Search for Disjunctive Scheduling." 26th European Conference on Artificial Intelligence (ECAI 2023)). 2023</p>
</details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.PropaGroup.source" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">source</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">source</span><span class="p">:</span> <span class="n">SignedVar</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Source signed variable of the propagators of the group.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.PropaGroup.target" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">target</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">target</span><span class="p">:</span> <span class="n">SignedVar</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Target signed variable of the propagators of the group.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.PropaGroup.weight" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">weight</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">weight</span><span class="p">:</span> <span class="n">Bound</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Weight of the propagators of the group.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.PropaGroup.enabler" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">enabler</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">enabler</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">Enabler</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The enabler of the propagators of the group.</p>
<p>It is non None when the group is active (i.e. when its propagators
are active, i.e. participate in propagation).</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.PropaGroup.potential_enablers" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">potential_enablers</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">potential_enablers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">Enabler</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>A set of potential enablers for the propagators of the group.</p>
<p>The group (or rather its propagators) becomes active once one of
these enablers' <code>active</code> and <code>valid</code> literals become True.</p>
  </div>

</div>





  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.Enabler" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Enabler</span>


</h6>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>

  
      <p>Represents the conditions for a propagator to be enabled
(which is for literals <code>active</code> and <code>valid</code> to both be true).</p>


  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.Enabler.active" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">active</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">active</span><span class="p">:</span> <span class="n">Lit</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>When this literal is present (i.e. its variable is present), then it is
true iff the propagators (enabled by this enabler) are active.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.Enabler.valid" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">valid</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">valid</span><span class="p">:</span> <span class="n">Lit</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>This literal is true iff the propagators (enabled by this enabler) are
within its scope (i.e. when it is known to be sound to propagate
a change from the propagator's source to the propagator's target)</p>
<p>In the simplest cast, <code>valid = presence(active)</code> (since by construction
<code>presence(active)</code> is true iff both the source and the target of the
propagator are present).</p>
<p><code>valid</code> may be a more specific literal, but it always satisfies that
<code>presence(active) =&gt; valid</code>.</p>
  </div>

</div>





  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.ConstraintsDatabase" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ConstraintsDatabase</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h6>


  <div class="doc doc-contents ">

  
      <p>The constraints database, in which constraints are implemented through propagators.</p>


  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.ConstraintsDatabase.propagators" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">propagators</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">propagators</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">,</span> <span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroup</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Stores all propagators (both active and inactive) as groups or "bundles" of
propagators sharing their source, target, and weight.</p>

<details class="note" open>
  <summary>Note</summary>
  <p>Each difference constraint / STN edge (i.e. <code>v2-v1 &lt;= d</code>, i.e. <code>v1 -d-&gt; v2</code>)
added is converted into 4 propagators, which correspond to:</p>
<ul>
<li>
<p>the forward (source -&gt; target) view of the "canonical" (i.e. "normal") edge</p>
</li>
<li>
<p>the backward (target -&gt; source) view of the "canonical" (i.e. "normal") edge</p>
</li>
<li>
<p>the forward (source -&gt; target) view of the "negated" (i.e. negation of canonical) edge</p>
</li>
<li>
<p>the backward (target -&gt; source) view of the "negated" (i.e. negation of canonical) edge</p>
</li>
</ul>
<p>Make no mistake, at no point will those 4 propagators be part of the same group !
None of them have the same source, target, and weight !</p>
</details>  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.ConstraintsDatabase.propagators_list" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">propagators_list</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">propagators_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Ordered view of <code>propagators</code>.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.ConstraintsDatabase.propagators_source_and_target" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">propagators_source_and_target</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">propagators_source_and_target</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">SignedVar</span><span class="p">,</span> <span class="n">SignedVar</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Associates (source, target) pairs of signed variables to propagators defined on them.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.ConstraintsDatabase.intermittent_propagators" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">intermittent_propagators</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">intermittent_propagators</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">SignedVar</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">SignedVar</span><span class="p">,</span> <span class="n">Bound</span><span class="p">,</span> <span class="n">Lit</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Stores propagators whose active or not status may depend on the current state.</p>

<details class="note" open>
  <summary>Note</summary>
  <p>A key in the dictionary corresponds to a propagator's <code>source</code>.
A value in the dictionary corresponds to a list of
tuples <code>(target, weight, presence)</code> for that propagator.</p>
<p>Here <code>presence</code> is a literal that is true iff the propagator is present.
But note that handling of optional variables might allow an edge to
propagate even if it is not known to be present yet.</p>
</details>  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.ConstraintsDatabase.watches" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">watches</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">watches</span><span class="p">:</span> <span class="n">SetGuardedByLits</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">,</span> <span class="n">DiffReasoner</span><span class="o">.</span><span class="n">Enabler</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">SetGuardedByLits</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Associates (watched) literals to (propagator, enabler) pairs.
When a watched literal becomes true, and the associated enabler's
<code>valid</code> and <code>active</code> literals are true as well, the associated propagator
is triggered (i.e. added to a propagation queue).</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.ConstraintsDatabase.propagators_events_trail" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">propagators_events_trail</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">propagators_events_trail</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">,</span> <span class="n">DiffReasoner</span><span class="o">.</span><span class="n">Enabler</span><span class="p">]]]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span> <span class="p">:</span> <span class="p">[[]])</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Holds the trail of "propagator groups events", which are:
- The addition of a new propagator group (encoded as None).
- The addition of a new enabler to an existing propagator group's potential enablers (encoded as a tuple).</p>
<p>The maintenance of the history of these events
is necessary to allow resetting to a previous state.</p>
  </div>

</div>





  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.ShortestPathTheoryPropCause" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ShortestPathTheoryPropCause</span>


</h6>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>

  
      <p>Represents a theory propagation cause corresponding to the activation
of the propagators represented by <code>triggering_propagator_group_id</code>, as
a result of the appearance of a new shortest path through it,
between <code>source</code> and <code>target</code>.</p>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.InvalidBoundsTheoryPropCause" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">InvalidBoundsTheoryPropCause</span>


</h6>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>

  
      <p>Represents a theory propagation cause corresponding to the incompability
of the <code>source_lit</code> and <code>target_lit</code> literals with an "edge" (represented
by a propagator group).</p>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.EdgePropInferenceCause" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">EdgePropInferenceCause</span>


</h6>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>

  
      <p>Represents the cause of an inference (i.e. bound update of a signed variable)
corresponding to an edge propagation (i.e. application of a propagator representing that edge).</p>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.TheoryPropInferenceCause" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">TheoryPropInferenceCause</span>


</h6>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>

  
      <p>Represents the cause of an inference (i.e. bound update of a signed variable)
corresponding to a theory propagation, whose own cause was registered at
<code>theory_propagation_cause_index</code> in <code>DiffReasoner.theory_propagation_causes</code>.</p>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DijkstraState</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h6>


  <div class="doc doc-contents ">

  
      <p>A structure that contains the mutable data that is updated during a run of
Dijkstra's algorithm. It is intended to be reusable across multiple runs.</p>


  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState.latest" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">latest</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">latest</span><span class="p">:</span> <span class="n">Bound</span> <span class="o">=</span> <span class="n">Bound</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The latest distance that was extract from the queue. As a property of the
Dijkstra algorithm, if a distance in the <code>distances</code> table is less than or
equal to this value, then it will not change for the rest of the process.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState.distances" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">distances</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">distances</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">SignedVar</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Bound</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Associates each node of the network to its distance. If the node is
not an origin, it also indicates the latest edge on the shortest path to this node.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState.queue" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">queue</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">queue</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Bound</span><span class="p">,</span> <span class="n">SignedVar</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Elements of the queue that have not been extracted yet.
Note that a single node might appear several times in the queue,
in which case only the one with the smallest distance is relevant.
The <code>Bound</code> corresponds to the reduced distance from the
origin to the <code>SignedVar</code> node.</p>
<p>Represented with Python's heapq, which is a min-heap.</p>
  </div>

</div>




<div class="doc doc-object doc-function">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState.enqueue" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">enqueue</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">enqueue</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">SignedVar</span><span class="p">,</span> <span class="n">dist</span><span class="p">:</span> <span class="n">Bound</span><span class="p">,</span> <span class="n">incoming_edge</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Add a node to the queue, indicating the distance from the origin and
the latest edge on the path from the origin to this node.</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState.dequeue" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">dequeue</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">dequeue</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Bound</span><span class="p">,</span> <span class="n">SignedVar</span><span class="p">]]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Remove the next element in the queue.
Nodes are removed by increasing distance to the origin.
Each node can only be extracted once.</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[<a class="autorefs autorefs-internal" title="src.fundamentals.Bound" href="../fundamentals/#src.fundamentals.Bound">Bound</a>, <a class="autorefs autorefs-internal" title="src.fundamentals.SignedVar" href="../fundamentals/#src.fundamentals.SignedVar">SignedVar</a>]]</code>
        
        <div class="doc-md-description">
          <p>The removed element (if any).</p>
      </div>
      </li>
  </ul>

  </div>

</div>


<div class="doc doc-object doc-function">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState.distance" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">distance</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">distance</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">SignedVar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Bound</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="src.fundamentals.Bound" href="../fundamentals/#src.fundamentals.Bound">Bound</a>]</code>
        
        <div class="doc-md-description">
          <p>The distance from the origin to this node,                     or None if the node was not reached by Dijkstra's algorithm</p>
      </div>
      </li>
  </ul>

  </div>

</div>


<div class="doc doc-object doc-function">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState.reached_nodes" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">reached_nodes</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">reached_nodes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Bound</span><span class="p">,</span> <span class="n">SignedVar</span><span class="p">]]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="typing.Iterable">Iterable</span>[<span title="typing.Tuple">Tuple</span>[<a class="autorefs autorefs-internal" title="src.fundamentals.Bound" href="../fundamentals/#src.fundamentals.Bound">Bound</a>, <a class="autorefs autorefs-internal" title="src.fundamentals.SignedVar" href="../fundamentals/#src.fundamentals.SignedVar">SignedVar</a>]]</code>
        
        <div class="doc-md-description">
          <p>An iterator over all nodes (and their distances from                     the origin) that were reached by Dijkstra's algorithm.</p>
      </div>
      </li>
  </ul>

  </div>

</div>


<div class="doc doc-object doc-function">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState.predecessor" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">predecessor</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">predecessor</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">SignedVar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DiffReasoner</span><span class="o">.</span><span class="n">PropaGroupId</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="typing.Optional">Optional</span>[<span title="src.solver.reasoners.diff_reasoner.DiffReasoner.PropaGroupId">PropaGroupId</span>]</code>
        
        <div class="doc-md-description">
          <p>The predecessor edge from the origin to this node or None if it is an origin.</p>
      </div>
      </li>
  </ul>



  <p>Raises:</p>
  <ul>
      <li class="field-body">
            <code>KeyError</code>
          
        <div class="doc-md-description">
          <p>if the node has no associated distance (i.e. was not reached by the algorithm)</p>
        </div>
      </li>
  </ul>

  </div>

</div>


<div class="doc doc-object doc-function">




<h7 id="src.solver.reasoners.diff_reasoner.DiffReasoner.DijkstraState.is_final" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_final</span>


</h7>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_final</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">SignedVar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        
        <div class="doc-md-description">
          <p>True if the node has a distance that is guaranteed not to                     change in subsequent iterations. False otherwise.</p>
      </div>
      </li>
  </ul>

  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.add_reified_difference_constraint" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">add_reified_difference_constraint</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">add_reified_difference_constraint</span><span class="p">(</span><span class="n">reification_literal</span><span class="p">:</span> <span class="n">Lit</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">Var</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Var</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Adds a new difference constraint <code>target - source &lt;= weight</code>, i.e. STN
edge <code>source --weight--&gt; target</code>, which was already reified into <code>reification_literal</code>.</p>
<p>Note:</p>
<pre><code>This is done by following these steps:

1. Decompose the difference constraint into 4 propagators, which will be
"active" iff `reification_literal` is true, and "valid" iff the variable
of their target signed variable is present. (see `Enabler`).

And then for each of these 4 propagators:

2. Integrate the new propagator to the propagator database (recall that 
a propagator group "bundles" propagators which only differ by enabling conditions).
For each new propagator, this is done by either:

- Merging / adding the new propagator into an existing group
of propagators, by adding its enabler to their `potential_enablers`.

- Tightening an already active existing group of propagators
(superseded by the new propagator), by setting their weight to
the new propagator's weight.

- Ignoring the new propagator, if it is redundant with an
existing one (i.e. if its weight is weaker than an existing
propagator's with the same enabling conditions).

- Creating a new propagator group with the new propagator's enabler,
if there are no existing propagators with the same source and target.

NOTE that merging, tightening, or ignoring is only done when the solver
is at the top decision level. Beyond the top decision level, we always choose 
to create a new propagator group, because it would be too complicated to
undo/backtrack the reorganization of a propagator group.

3. Postprocess the integration of the new propagator. The two possibilities are the following:

- Either set the propagators of the group (to which the new propagator was added)
as pending for activation, if the enabling conditions of the new propagator
are satisfied (`active` and `valid` literals of its enabler are true).

- Or set watch on the enabling conditions of the new propagator (the `active`
and `valid` literals of its enabler), if they aren't known to be true yet, so
that we're notified when one of them becomes true. (If both of them are true,
the propagator group will be staged as pending for activation).
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.on_solver_increment_decision_level_by_one" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">on_solver_increment_decision_level_by_one</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">on_solver_increment_decision_level_by_one</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>See <code>Reasoner.on_solver_increment_decision_level_by_one</code>.</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.on_solver_backtrack_one_decision_level" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">on_solver_backtrack_one_decision_level</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">on_solver_backtrack_one_decision_level</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>See <code>Reasoner.on_solver_backtrack_one_decision_level</code>.</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.propagate" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">propagate</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">propagate</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InvalidBoundUpdate</span> <span class="o">|</span> <span class="n">ReasonerBaseExplanation</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Main propagation method of the Difference Logic reasoner.</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="src.solver.common.InvalidBoundUpdate" href="../common/#src.solver.common.InvalidBoundUpdate">InvalidBoundUpdate</a> | <a class="autorefs autorefs-internal" title="src.solver.common.ReasonerBaseExplanation" href="../common/#src.solver.common.ReasonerBaseExplanation">ReasonerBaseExplanation</a>]</code>
        
        <div class="doc-md-description">
          <p>A base explanation for a conflict, if one is encountered.                 None if propagation is successful.</p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Note</summary>
  <p>See <code>_propagate</code> for more complete documentation.</p>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.reasoners.diff_reasoner.DiffReasoner.explain" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">explain</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">explain</span><span class="p">(</span><span class="n">explanation</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Lit</span><span class="p">],</span> <span class="n">literal</span><span class="p">:</span> <span class="n">Lit</span><span class="p">,</span> <span class="n">inference_cause</span><span class="p">:</span> <span class="n">Causes</span><span class="o">.</span><span class="n">ReasonerInference</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>See <code>Reasoner.explain</code>.</p>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>