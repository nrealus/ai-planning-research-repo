
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../solver_state/">
      
      
        <link rel="next" href="../reasoner/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.8">
    
    
      
        <title>Solver Main Class - AI Planning Research Project</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.046329b4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra_style.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#src.solver.solver.Solver" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AI Planning Research Project" class="md-header__button md-logo" aria-label="AI Planning Research Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AI Planning Research Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Solver Main Class
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AI Planning Research Project" class="md-nav__button md-logo" aria-label="AI Planning Research Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    AI Planning Research Project
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../cdcl_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example CDCL search
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../fundamentals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fundamentals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../constraint_expressions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constraint Expressions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Solver
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Solver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../solver_state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solver State
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Solver Main Class
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Solver Main Class
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.solver.solver.Solver" class="md-nav__link">
    Solver
  </a>
  
    <nav class="md-nav" aria-label="Solver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.increment_decision_level_by_one" class="md-nav__link">
    increment_decision_level_by_one()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.backtrack_to_decision_level" class="md-nav__link">
    backtrack_to_decision_level()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.propagate" class="md-nav__link">
    propagate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.explain_invalid_bound_update" class="md-nav__link">
    explain_invalid_bound_update()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.refine_explanation" class="md-nav__link">
    refine_explanation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.get_decision_level_to_backtrack_to" class="md-nav__link">
    get_decision_level_to_backtrack_to()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.add_new_non_optional_variable" class="md-nav__link">
    add_new_non_optional_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.add_new_optional_variable" class="md-nav__link">
    add_new_optional_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.add_new_presence_variable" class="md-nav__link">
    add_new_presence_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.add_constraint" class="md-nav__link">
    add_constraint()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.add_scoped_constraint" class="md-nav__link">
    add_scoped_constraint()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_4" >
        
          <label class="md-nav__link" for="__nav_4_3_4" id="__nav_4_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reasoners
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_4">
            <span class="md-nav__icon md-icon"></span>
            Reasoners
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../reasoner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reasoner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sat_reasoner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAT Reasoner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../diff_reasoner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Difference Logic Reasoner
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_5" >
        
          <label class="md-nav__link" for="__nav_4_3_5" id="__nav_4_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Branchers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_5">
            <span class="md-nav__icon md-icon"></span>
            Branchers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../brancher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Brancher
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.solver.solver.Solver" class="md-nav__link">
    Solver
  </a>
  
    <nav class="md-nav" aria-label="Solver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.increment_decision_level_by_one" class="md-nav__link">
    increment_decision_level_by_one()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.backtrack_to_decision_level" class="md-nav__link">
    backtrack_to_decision_level()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.propagate" class="md-nav__link">
    propagate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.explain_invalid_bound_update" class="md-nav__link">
    explain_invalid_bound_update()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.refine_explanation" class="md-nav__link">
    refine_explanation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.get_decision_level_to_backtrack_to" class="md-nav__link">
    get_decision_level_to_backtrack_to()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.add_new_non_optional_variable" class="md-nav__link">
    add_new_non_optional_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.add_new_optional_variable" class="md-nav__link">
    add_new_optional_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.add_new_presence_variable" class="md-nav__link">
    add_new_presence_variable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.add_constraint" class="md-nav__link">
    add_constraint()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.solver.solver.Solver.add_scoped_constraint" class="md-nav__link">
    add_scoped_constraint()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Solver Main Class</h1>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">
  
      <p>This module defines the main high-level class of the solver.</p>
<p>It contains (relatively) high-level methods to use when encoding a problem,
or when writing a search / solving function.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h5 id="src.solver.solver.Solver" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Solver</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">Solver</span><span class="p">(</span><span class="n">use_sat_reasoner</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">use_diff_reasoner</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">

  
      <p>TODO</p>


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.increment_decision_level_by_one" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">increment_decision_level_by_one</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">increment_decision_level_by_one</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Increments the current decision level by 1
(i.e. moves the solver to the next decision level).</p>

<details class="note" open>
  <summary>Note</summary>
  <p>Invokes all reasoners' <code>on_solver_increment_decision_level</code> callbacks, which
updates them internally to account for the decision level incrementation.</p>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.backtrack_to_decision_level" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">backtrack_to_decision_level</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backtrack_to_decision_level</span><span class="p">(</span><span class="n">target_decision_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Backtracks to the <code>target_decision_level</code> by reverting all events at all
decision levels strictly greater than the target one.</p>



  <p>Raises:</p>
  <ul>
      <li class="field-body">
            <code>ValueError</code>
          –
        <div class="doc-md-description">
          <p>If the target decision level was strictly less than 0.</p>
        </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Note</summary>
  <p>Invokes the reasoners' <code>on_solver_backtrack_one_level</code> callbacks, at
each reverted decision level. This updates the reasoners internally
to account for the backtracking.</p>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.propagate" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">propagate</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">propagate</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">InvalidBoundUpdate</span> <span class="o">|</span> <span class="n">ReasonerBaseExplanation</span><span class="p">,</span> <span class="n">Reasoner</span><span class="p">]]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Propagates the changes accumulated since the last call to this method,
until nothing new can be inferred.</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[<a class="autorefs autorefs-internal" title="src.solver.common.InvalidBoundUpdate" href="../common/#src.solver.common.InvalidBoundUpdate">InvalidBoundUpdate</a> | <a class="autorefs autorefs-internal" title="src.solver.common.ReasonerBaseExplanation" href="../common/#src.solver.common.ReasonerBaseExplanation">ReasonerBaseExplanation</a>, <a class="autorefs autorefs-internal" title="src.solver.reasoners.reasoner.Reasoner" href="../reasoner/#src.solver.reasoners.reasoner.Reasoner">Reasoner</a>]]</code>
        –
        <div class="doc-md-description">
          <p>None if the propagation was successful, and a tuple if a conflict                 is encountered. The tuple contains information on the                 conflict as well as the reasoner that encountered it.</p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Note</summary>
  <p>Proceeds by first posting the reified constraints whose scope is
not false. Then, propagates new events to reasoners, until either
a conflict is encountered or there are no more new events.</p>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.explain_invalid_bound_update" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">explain_invalid_bound_update</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">explain_invalid_bound_update</span><span class="p">(</span><span class="n">invalid_bound_update</span><span class="p">:</span> <span class="n">InvalidBoundUpdate</span><span class="p">,</span> <span class="n">explain_function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">List</span><span class="p">[</span><span class="n">Lit</span><span class="p">],</span> <span class="n">Lit</span><span class="p">,</span> <span class="n">Causes</span><span class="o">.</span><span class="n">ReasonerInference</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">ConflictAnalysisResult</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Performs explanation / conflict analysis of an <code>invalid_bound_update</code>.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>invalid_bound_update</b>
            (<code><a class="autorefs autorefs-internal" title="src.solver.common.InvalidBoundUpdate" href="../common/#src.solver.common.InvalidBoundUpdate">InvalidBoundUpdate</a></code>)
        –
        <div class="doc-md-description">
          <p>The invalid bound update (conflict) to explain.</p>
        </div>
      </li>
      <li class="field-body">
        <b>explain_function</b>
            (<code><span title="typing.Callable">Callable</span>[[<span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="src.fundamentals.Lit" href="../fundamentals/#src.fundamentals.Lit">Lit</a>], <a class="autorefs autorefs-internal" title="src.fundamentals.Lit" href="../fundamentals/#src.fundamentals.Lit">Lit</a>, <a class="autorefs autorefs-internal" title="src.solver.common.Causes.ReasonerInference" href="../common/#src.solver.common.Causes.ReasonerInference">ReasonerInference</a>], None]</code>)
        –
        <div class="doc-md-description">
          <p>An external function that may participate in building                 the explanation (basically the <code>explain</code> function of a relevant <code>Reasoner</code>).</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="src.solver.common.ConflictAnalysisResult" href="../common/#src.solver.common.ConflictAnalysisResult">ConflictAnalysisResult</a></code>
        –
        <div class="doc-md-description">
          <p>The results of conflict analysis.</p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Note</summary>
  <p>Given an invalid bound update of a literal <code>l</code>, returns an asserting
clause <code>l_1 &amp; ... &amp; l_n =&gt; (!l_dec)</code> (i.e. <code>!l_1 | ... | !l_n | !l_dec</code>) where:</p>
<ul>
<li>
<p>the literals 'l_i' are entailed at the previous decision level (of the current state)</p>
</li>
<li>
<p>the literal 'l_dec' is the decisions that was taken at the current decision level</p>
</li>
</ul>
<p>The update of 'l' must not directly originate from a decision, as it is
necessarily the case that 'not l' holds in the current state. It is
thus considered a logic error to enforce an obviously wrong decision.</p>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.refine_explanation" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">refine_explanation</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">refine_explanation</span><span class="p">(</span><span class="n">explanation</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Lit</span><span class="p">],</span> <span class="n">explain_function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">List</span><span class="p">[</span><span class="n">Lit</span><span class="p">],</span> <span class="n">Lit</span><span class="p">,</span> <span class="n">Causes</span><span class="o">.</span><span class="n">ReasonerInference</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">ConflictAnalysisResult</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Refines an explanation into an asserting clause.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>explanation</b>
            (<code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="src.fundamentals.Lit" href="../fundamentals/#src.fundamentals.Lit">Lit</a>]</code>)
        –
        <div class="doc-md-description">
          <p>The list of literals making up the explanation.                   Modified by the method.</p>
        </div>
      </li>
      <li class="field-body">
        <b>explain_function</b>
            (<code><span title="typing.Callable">Callable</span>[[<span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="src.fundamentals.Lit" href="../fundamentals/#src.fundamentals.Lit">Lit</a>], <a class="autorefs autorefs-internal" title="src.fundamentals.Lit" href="../fundamentals/#src.fundamentals.Lit">Lit</a>, <a class="autorefs autorefs-internal" title="src.solver.common.Causes.ReasonerInference" href="../common/#src.solver.common.Causes.ReasonerInference">ReasonerInference</a>], None]</code>)
        –
        <div class="doc-md-description">
          <p>An external function that may participate in building                 the explanation (basically the <code>explain</code> function of a relevant <code>Reasoner</code>).</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="src.solver.common.ConflictAnalysisResult" href="../common/#src.solver.common.ConflictAnalysisResult">ConflictAnalysisResult</a></code>
        –
        <div class="doc-md-description">
          <p>The results of conflict analysis.</p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Note</summary>
  <p>A partial backtrack (within the current decision level) will occur
in this function. This is necessary to provide explainers (reasoners)
with the exact state in which their decisions were made.</p>
<p>Do not worry though, there is no need to "synchronize" the reasoners' 
"cursors" of what new events to process next. Indeed, right after the
explanation is made as part of conflict analysis, CDCL search will
backtrack to an earlier decision level anyway.</p>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.get_decision_level_to_backtrack_to" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_decision_level_to_backtrack_to</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_decision_level_to_backtrack_to</span><span class="p">(</span><span class="n">asserting_clause_literals</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Lit</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Lit</span><span class="p">]]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>asserting_clause_literals</b>
            (<code><span title="typing.Tuple">Tuple</span>[<a class="autorefs autorefs-internal" title="src.fundamentals.Lit" href="../fundamentals/#src.fundamentals.Lit">Lit</a>, ...]</code>)
        –
        <div class="doc-md-description">
          <p>The literals composing an asserting clause.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="typing.Tuple">Tuple</span>[bool, int, <span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="src.fundamentals.Lit" href="../fundamentals/#src.fundamentals.Lit">Lit</a>]]</code>
        –
        <div class="doc-md-description">
          <p>A tuple interpreted as follows:</p>
<ul>
<li>
<p>1st element indicates whether the clause is conflicting at the                     top decision level (which would prove unsatisfiability).</p>
</li>
<li>
<p>2nd element indicates the appropriate backtrack level.</p>
</li>
<li>
<p>3rd element indicates the literal asserted at that level (if any).</p>
</li>
</ul>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Note</summary>
  <p>Normally, in the 1UIP backtracking scheme (1st Unique Implication Point),
the decision level to backtrack to should be the largest one (i.e. "closest"
to the conflict) at which the clause is unit. However, the explanation of
eager propagation of optionals might generate explanations where some literals
are not violated. These are ignored when determining the backtrack level.</p>
<p>If there is more than one violated literal at that level, then no literal is
asserted and the determined backtrack level is further decreased by 1. This might
occur with clause sharing.</p>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.add_new_non_optional_variable" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">add_new_non_optional_variable</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">add_new_non_optional_variable</span><span class="p">(</span><span class="n">initial_domain</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">controllable</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Var</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Registers and returns a new non optional variable with the given <code>initial_domain</code>.</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.add_new_optional_variable" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">add_new_optional_variable</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">add_new_optional_variable</span><span class="p">(</span><span class="n">initial_domain</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">controllable</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">presence_literal</span><span class="p">:</span> <span class="n">Lit</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Var</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Registers and returns a new variable with the given <code>initial_domain</code> and <code>presence_literal</code>.</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.add_new_presence_variable" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">add_new_presence_variable</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">add_new_presence_variable</span><span class="p">(</span><span class="n">scope_representative_literal</span><span class="p">:</span> <span class="n">Lit</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Var</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Registers and returns a new presence variable
defined in the scope corresponding to <code>scope_literal</code>.</p>
<p>TODO: details on scopes ?</p>

<details class="note" open>
  <summary>Note</summary>
  <p>A presence variable is simply a non optional variable with initial
domain (0, 1) used to encode presence literals. A presence literal
is a literal <code>[pvar &gt;= 1]</code> where <code>pvar</code> is a presence variable.</p>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.add_constraint" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">add_constraint</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">add_constraint</span><span class="p">(</span><span class="n">constr_expr</span><span class="p">:</span> <span class="n">ConstrExpr</span><span class="p">,</span> <span class="n">constr_value_lit</span><span class="p">:</span> <span class="n">Lit</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Adds a constraint defined by the given high-level expression <code>constr_expr</code>,
enforced to hold iff <code>constr_value_lit</code> is true.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>constr_expr</b>
            (<code><a class="autorefs autorefs-internal" title="src.constraint_expressions.ConstrExpr" href="../constraint_expressions/#src.constraint_expressions.ConstrExpr">ConstrExpr</a></code>)
        –
        <div class="doc-md-description">
          <p>A high-level constraint expression defining the constraint.</p>
        </div>
      </li>
      <li class="field-body">
        <b>constr_value_lit</b>
            (<code><a class="autorefs autorefs-internal" title="src.fundamentals.Lit" href="../fundamentals/#src.fundamentals.Lit">Lit</a></code>)
        –
        <div class="doc-md-description">
          <p>A literal that should be true iff the constraint holds.</p>
        </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Note</summary>
  <p>Internally, <code>constr_expr</code> is preprocessed into a low-level, elementary
form. This "elementary form" constraint may make use of new,
"intermediary" literals created during the preprocessing.</p>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h6 id="src.solver.solver.Solver.add_scoped_constraint" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">add_scoped_constraint</span>


</h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">add_scoped_constraint</span><span class="p">(</span><span class="n">constr_expr</span><span class="p">:</span> <span class="n">ConstrExpr</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Lit</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Lit</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Adds a constraint defined by the given high-level expression <code>constr_expr</code>,
enforced to hold in the given <code>scope</code>. This corresponds to a full constraint
<code>l_1 &amp; ... &amp; l_n =&gt; "constraint holds"</code> (where <code>l_i</code> are the literals of <code>scope</code>),
i.e. <code>`scope_tautology_literal</code> &lt;=&gt; "constraint holds"<code>(where</code>scope_tautology_literal<code>is the</code>scope`'s tautology literal).</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>constr_expr</b>
            (<code><a class="autorefs autorefs-internal" title="src.constraint_expressions.ConstrExpr" href="../constraint_expressions/#src.constraint_expressions.ConstrExpr">ConstrExpr</a></code>)
        –
        <div class="doc-md-description">
          <p>A high-level constraint expression defining the constraint.</p>
        </div>
      </li>
      <li class="field-body">
        <b>scope</b>
            (<code><span title="typing.Tuple">Tuple</span>[<a class="autorefs autorefs-internal" title="src.fundamentals.Lit" href="../fundamentals/#src.fundamentals.Lit">Lit</a>, ...]</code>)
        –
        <div class="doc-md-description">
          <p>The scope in which the constraint must hold.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="src.fundamentals.Lit" href="../fundamentals/#src.fundamentals.Lit">Lit</a></code>
        –
        <div class="doc-md-description">
          <p>The <code>scope</code>'s tautology literal.</p>
      </div>
      </li>
  </ul>

<details class="note" open>
  <summary>Note</summary>
  <p>Internally, <code>constr_expr</code> is preprocessed into a low-level, elementary
form. This "elementary form" constraint may make use of new,
"intermediary" literals created during the preprocessing.</p>
</details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>